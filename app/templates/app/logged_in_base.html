{% extends "app/base.html" %}
{% load i18n static settings %}

{% block navbar-top-links %}
  {# Placeholder for top navbar links, can be customized in child templates #}
{% endblock %}

{% block navbar-sidebar %}
<div class="navbar-default sidebar" role="navigation" style="position: fixed; display: flex; flex-direction: column; height: 100vh; background-color: #FFFFFF; width: 250px; box-shadow: 0px 4px 4px 0px #00000040;">
    <div class="sidebar-nav navbar-collapse" style="display: flex; flex-direction: column; height: 100%;">
      <!-- Logo -->
      <div style="padding: 20px; text-align: center;">
        <a class="aaa" href="/" style="display: inline-block;">
          <img src="{% static 'images/73cc85ec5b07fd3676243df62c885fef.png' %}" alt="{{ SETTINGS.app_name }}" style="max-width: 150px; height: auto;" />
        </a>
      </div>
  
      <!-- Main Menu -->
      <ul class="nav" id="side-menu" style="list-style: none; padding: 0; margin: 0; flex-grow: 1; overflow-y: auto;">
        <li>
          <a href="/dashboard/" style="display: block; padding: 15px 20px; color: #013372; text-decoration: none;">
            <i class="fa fa-tachometer-alt fa-fw" style="margin-right: 10px;"></i> {% trans 'Dashboard' %}
          </a>
        </li>
  
        {% load processingnode_extras plugins %}
        {% can_view_processing_nodes as view_nodes %}
        {% can_add_processing_nodes as add_nodes %}
        {% get_visible_processing_nodes as nodes %}
        {% get_plugins_main_menus as plugin_menus %}
        
        {% for menu in plugin_menus %}
          <li>
            <a href="{{menu.link}}" style="display: block; padding: 15px 20px; color: #013372; text-decoration: none;">
              <i class="{{menu.css_icon}}" style="margin-right: 10px;"></i> {{menu.label}}
              {% if menu.has_submenu %}<span class="fa arrow" style="float: right;"></span>{% endif %}
            </a>
            
            {% if menu.has_submenu %}
              <ul style="list-style: none; padding-left: 20px;">
                {% for submenu in menu.submenu %}
                  <li>
                    <a href="{{submenu.link}}" style="display: block; padding: 10px 20px; color: #013372; text-decoration: none;">
                      <i class="{{submenu.css_icon}}" style="margin-right: 10px;"></i> {{submenu.label}}
                    </a>
                  </li>
                {% endfor %}
              </ul>
            {% endif %}
          </li>
        {% endfor %}
  
        {% if view_nodes %}
          <li>
            <a href="#" style="display: block; padding: 15px 20px; color: #013372; text-decoration: none;">
              <i class="fa fa-wrench fa-fw" style="margin-right: 10px;"></i> {% trans 'Processing Nodes' %}<span class="fa arrow" style="float: right;"></span>
            </a>
            <ul style="list-style: none; padding-left: 20px;">
              {% for node in nodes %}
                <li>
                  <a href="{% url 'processing_node' node.id %}" style="display: block; padding: 10px 20px; color: #013372; text-decoration: none;">
                    <span class="fa fa-laptop {% if not node.is_online %}theme-color-button-danger{% endif %}" style="margin-right: 10px;"></span>
                    {{node}}
                  </a>
                </li>
              {% endfor %}
              {% if add_nodes %}
                <li>
                  <a href="{% url 'admin:nodeodm_processingnode_add' %}" style="display: block; padding: 10px 20px; color: #013372; text-decoration: none;">
                    <span class="fa fa-plus-circle" style="margin-right: 10px;"></span> {% trans 'Add New' %}
                  </a>
                </li>
              {% endif %}
            </ul>
          </li>
        {% endif %}
  
        {% if user.is_staff %}
          <!-- Admin section (collapsed for brevity) -->
        {% endif %}
  
        {% is_dev_mode as dev_mode %}
        {% if dev_mode and user.is_superuser %}
          <li>
            <a href="/dev-tools/" style="display: block; padding: 15px 20px; color: #013372; text-decoration: none;">
              <i class="fa fa-bug fa-fw" style="margin-right: 10px;"></i> {% trans 'Developer Tools' %}
            </a>
          </li>
        {% endif %}
  
        <li id="about-menu">
          <a href="/about/" style="display: block; padding: 15px 20px; color: #013372; text-decoration: none;">
            <i class="fa fa-info-circle fa-fw" style="margin-right: 10px;"></i> {% trans 'About' %}
          </a>
        </li>
      </ul>
  
      <!-- Spacer -->
      <div style="flex-grow: 1;"></div>
  
      <!-- Logout Button -->
      {% is_single_user_mode as single_user %}
      {% if not single_user %}
        <ul class="nav logout" id="side-menu" style="list-style: none; padding: 0; margin: 0;">
          <li>
            <a href="/logout/" style="display: block; padding: 15px 20px; color: #4D4D4D; text-decoration: none;">
              <i class="fa fa-sign-out-alt fa-fw" style="margin-right: 10px;color: #F7941E;"></i> {% trans 'Logout' %}
            </a>
          </li>
        </ul>
      {% endif %}
    </div>
  </div>
<!-- /.navbar-static-side -->
{% endblock %}

{% block page-wrapper %}
<div id="page-wrapper">
  <section class="main">
    <div class="content">
      {# Additional HTML content after header defined in theme settings #}
      {{ SETTINGS.theme.html_after_header|safe }}
      {% block messages %}
        {# Display system messages #}
        {% for message in messages %}
          <div class="alert alert-{{ message.tags }} alert-dismissible">
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
            {{ message }}
          </div>
        {% endfor %}
      {% endblock %}
      {# Placeholder for the main content of the page #}
      {% block content %}{% endblock %}
    </div>
  </section>
</div>
{% endblock %}
